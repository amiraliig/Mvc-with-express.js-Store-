<%- include('../includes/head.ejs') %>
</head>

<body>
  <%- include('../includes/navigation.ejs') %>

  <main class="page">
    <section class="section">
      <div class="section__head">
        <h2 class="section__title">Your Orders</h2>
        <p class="section__lead">Every order, laid out clean and clear.</p>
      </div>
    </section>

    <% if (!orders || orders.length === 0) { %>
      <h2>No orders yet.</h2>
    <% } else { %>

      <% orders.forEach(o => { %>
        <section class="card">
          <div class="card__content">
            <h2>Order #<%= o._id %></h2>
          

            <% if (!o.items || o.items.length === 0) { %>
              <p>No products in this order.</p>
            <% } else { %>
              <ul>
                <% o.items.forEach(p => { %>
                  <li>
                    <strong><%= p.title %></strong>
                    — Qty: <%= p.quantity %>
                    — Price: $<%= p.price %>
                    — Line total: $<%= p.lineTotal %>
                  </li>
                <% }) %>
              </ul>

              <p>
                <strong>
                  Order total: $<%= o.totalPrice %>
                </strong>
              </p>
            <% } %>
          </div>
        </section>
      <% }) %>

    <% } %>
  </main>

<%- include('../includes/end.ejs') %>
