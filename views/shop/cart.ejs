<%- include('../includes/head.ejs') %>
  <link rel="stylesheet" href="/css/product.css">
  </head>

  <body>
    <%- include('../includes/navigation.ejs') %>  

      <main class="page">
        <section class="section">
          <div class="section__head">
            <h2 class="section__title">Your Cart</h2>
            <p class="section__lead">Review your picks before checkout.</p>
          </div>
        </section>

        <% if (cartProducts.length> 0) { %>
          <div class="grid">
            <% for (let item of cartProducts) { %>
              <article class="card product-item">

                <header class="card__header">
                  <h1 class="product__title">
                    <%= item.productId.title %>
                  </h1>
                </header>

                <div class="card__image">
                  <img src="<%= item.productId.imageUrl %>" alt="<%= item.productId.title %>">
                </div>

                <div class="card__content">
                  <h2 class="product__price">
                    $<%= item.productId.price %>
                  </h2>

                  <p>
                    Quantity: <strong>
                      <%= item.quantity %>
                    </strong>
                  </p>

                  <p>
                    Total: $
                    <%= item.quantity * item.productId.price %>
                  </p>
                </div>

                <div class="card__actions">
                  <form action="/cart-delete-item" method="POST">
                    <input type="hidden" name="productId" value="<%= item.productId._id %>">
                    <button class="btn">Remove</button>
                  </form>
                </div>

              </article>
              <% } %>
          </div>

          <section class="card">
            <div class="card__content">
              <h2>
                Grand Total: $
                <%= cartProducts.reduce((sum, p)=> {
                  return sum + (p.quantity * p.productId.price)
                  }, 0) %>
              </h2>
            </div>

            <div class="card__actions">
              <button class="btn">Order Now</button>
              <%- include('../includes/checkoutBtn.ejs') %>
            </div>
          </section>

          <% } else { %>
            <h2>Your cart is empty!</h2>
            <% } %>
      </main>

      <%- include('../includes/end.ejs') %>
